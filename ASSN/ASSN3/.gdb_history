p touch3
start
set disassembly-flavor att
start
p touch3
exit
exit
start; p start_farm
start;
p start-farm
p start_farm
start
p start_farm
reg
disas getbuf
b 0x0000000000401863
b *0x0000000000401863
i b
r
i b
r -q
reg
delete 4
b *0x401867
r
reg rsp[

r
reg rsp
p getval_297
r
p getval_297
r
p getval_297
r
p getval_297
start
disas getbujf
disas getbuf
set disassembly-flavor att
disas getbuf
p touch1
gdb-peda$ p touch1
$1 = {void ()} 0x401879 <touch1>
vmm
vmm 0x55586000
disas getvyf'
disas getbuf
reg
b *0x000000000040186a
c
r
r -q
vmm 0x5560d638
i b
disable
disable 2
i b
disas getbuf
b *0x0000000000401863
b *0x0000000000401867
r
reg
c
reg
b clear
clear
delete 1
delete 2
delete 3
delete 4
clear
disas *getbuf
b *0x0000000000401863
r -q
vmm 0x5560d650
p touch2
r
start
ropgadget
ropsearch "?"
ropsearch "ret"
set disassembly-flavor att
ropgadget
ropsearch "rdi"
ropsearch "%rdi"
ropsearch "?rdi"
ropsearch "pop rdi"
disas addesp_40
disas *addesp_40
disas getval_168
disas *getval_168
disas test2
disas *test2
start
disas *test2
p touch2
disas *addesp_40
disas *setval_214
ropgadget
ropsearch "pop rdi"
disas *main
disas addval_174
p addval_174
p start_farm
p mid_farm
p end_farm
ropsearch 0x401a53 0x401b6c
ropsearch "" 0x401a53 0x401b6c
ropsearch "pop rsp" 0x401a53 0x401b6c
ropsearch "pop rdi" 0x401a53 0x401b6c
ropsearch "pop rax" 0x401a53 0x401b6c
disas 0x00401a84
disas getval_330
ropsearch "mov ?, rdi" 0x401a53 0x401b6c
ropsearch "pop rax" 0x401a53 0x401b6c
ropsearch "pop rdi" 0x401a53 0x401b6c
ropsearch "mov ?, rdi" 0x401a53 0x401b6c
ropsearch "mov rax, rdi" 0x401a53 0x401b6c
ropsearch "pop rax" 0x401a53 0x401b6c
disas 0x00401a84
x/3i gdb-peda$ disas 0x00401a84
Dump of assembler code for function getval_330:
   0x0000000000401a83 <+0>:mov    $0x90909058,%eax
   0x0000000000401a88 <+5>:retq   
End of assembler dump.
x/3i 0x00401a84
x/4i 0x00401a84
x/4=5i 0x00401a84
x/i 0x00401a84
x/0i 0x00401a84
x/10i 0x00401a84
x/5i 0x00401a84
disas 0x00401a70
x/2i 0x00401a70
cat cookie.txt
p touch2
ropsearch "add" 0x401a53 0x401b6c
ropsearch "add ?" 0x401a53 0x401b6c
ropsearch "add ?, ?" 0x401a53 0x401b6c
ropsearch "mov rsp, rax" 0x401a53 0x401b6c
ropsearch "mov rsp, ?" 0x401a53 0x401b6c
ropsearch "mov ?, ?" 0x401a53 0x401b6c
ropsearch "mov ?, eax" 0x401a53 0x401b6c
ropsearch "mov rsp, rax" 0x401a53 0x401b6c
ropsearch "mov %rsp, %rax" 0x401a53 0x401b6c
ropsearch "mov rax, rsp" 0x401a53 0x401b6c
ropsearch "mov %rsp, %rax" 0x401a53 0x401b6c
ropsearch "movq %rsp, %rax" 0x401a53 0x401b6c
ropsearch "mov ?, ?" 0x401a53 0x401b6c
disas 0x00401afa
x/3i 0x00401afa
x/2i 0x00401afa
disas 0x00401afa
x/2i 0x00401afa
disas 0x00401afa
x/2i 0x00401afa
x/2i 0x00401a91
disas 0x00401a91
x/2i 0x00401a91
p touch3
ropsearch "pop rdi" 0x401a53 0x401b6c
ropsearch "pop ?" 0x401a53 0x401b6c
ropsearch "mov rsp" 0x401a53 0x401b6c
ropsearch "mov ?, rsp" 0x401a53 0x401b6c
ropsearch "mov rsp, ?" 0x401a53 0x401b6c
ropsearch "mov rsp, rax" 0x401a53 0x401b6c
ropsearch "mov rax, rsp" 0x401a53 0x401b6c
