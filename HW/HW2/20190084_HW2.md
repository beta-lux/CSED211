CSED211 Homework 2
===

20190084 권민재

# 1. 
# 2. Exercise 3.60
Consider the following assembly code:
```asm
loop:
    movl %esi, %ecx
    movl $1, %edx
    movl $0, %eax
    jmp .L2
.L3:
    movq %rdi, %r8
    andq %rdx, %r8
    orq %r8, %rax
    salq %cl, %rdx
.L2:
    testq %rdx, %rdx
    jne .L3
    rep; ret
```
The preceding code was generated by compiling C code that had the following overall form:
```c
long loop(long x, long n){
    long result = ____;
    long mask;
    for (mask = ____; mask ____; mask = ____) {
        result |= ____;
    }
    return result;
}
```
Your task is to fill in the missing parts of the C code to get a program equivalent to the generated assembly code. Recall that the result of the function is returned in register %rax. You will find it helpful to examine the assembly code before, during, and after the loop to form a consistent mapping between the registers and the program variables.
## A. Which registers hold program values x, n, result, and mask?
* `x`: `rdi`
  * x64 calling convention에 따라, 첫번재 인자인 x는 rdi를 통해 전달받는다.
* `n`: `rsi`
  * x64 calling convention에 따라, 두번째 인자인 n은 rsi를 통해 전달받는다.
* `result`: `rax`
  * `result`는 반환되는 변수인데, 이는 주로 eax를 통해 전달한다.
* `mask`: `rdx`
  * `L3`에서 지속적으로 rdx를 비교한다는 점에서, rdx를 mask라고 추론할 수 있다.

## B. What are the initial values of result and mask?
* `result`: `0`
  * `movl $0, %eax`
* `mask`: `1`
  * `movl $1, %edx`

## C. What is the test condition for mask?
* `mask != 0`
  * `testq %rdx, %rdx`, `jne .L3`에서, rdx가 0이 아닐때 L3으로 점프하므로, 위와 같은 답을 생각할 수 있다.
    
## D. How does mask get updated?
* `mask = mask << n`
  * n은 `movl %esi, %ecx`에 의해 ecx에 그 값이 저장되는데, `salq %cl, %rdx`에서 이 값을 이용하여 마스크를 왼쪽으로 쉬프트하고 있다.
 
## E. How does result get updated?
* `result |= (x & mask)`
  * `movq %rdi, %r8`에서, x의 값이 임시로 r8에 저장되고, r8에 있는 값은 `orq %rdx, %r8`에 의해 mask와 and 연산을 당하게 된다. 이 값이 `orq %r8, %rax`에 의해 `result`에 or 연산이 된 후 담기므로, `result |= (x & mask)`와 같이 업데이트 된다고 말할 수 있다.

## F. Fill in all the missing parts of the C code.
```c
long loop(long x, long n){
    long result = 0;
    long mask;
    for (mask = 1; mask != 0; mask = << n) {
        result |= (x & mask);
    }
    return result;
}
```
# 3. Exercise 3.63
# 4. Exercise 3.64
# 5. Exercise 3.67
# 6. Exercise 3.68
# 7. Exercise 3.70